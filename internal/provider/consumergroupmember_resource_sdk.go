// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package provider

import (
	"context"
	"github.com/hashicorp/terraform-plugin-framework/diag"
	"github.com/hashicorp/terraform-plugin-framework/types"
	tfTypes "github.com/kong/terraform-provider-kong-gateway/internal/provider/types"
	"github.com/kong/terraform-provider-kong-gateway/internal/sdk/models/operations"
)

func (r *ConsumerGroupMemberResourceModel) RefreshFromOperationsAddConsumerToGroupResponseBody(ctx context.Context, resp *operations.AddConsumerToGroupResponseBody) diag.Diagnostics {
	var diags diag.Diagnostics

	if resp != nil {
		if resp.ConsumerGroup == nil {
			r.ConsumerGroup = nil
		} else {
			r.ConsumerGroup = &tfTypes.ConsumerGroup{}
			r.ConsumerGroup.CreatedAt = types.Int64PointerValue(resp.ConsumerGroup.CreatedAt)
			r.ConsumerGroup.ID = types.StringPointerValue(resp.ConsumerGroup.ID)
			r.ConsumerGroup.Name = types.StringValue(resp.ConsumerGroup.Name)
			if resp.ConsumerGroup.Tags != nil {
				r.ConsumerGroup.Tags = make([]types.String, 0, len(resp.ConsumerGroup.Tags))
				for _, v := range resp.ConsumerGroup.Tags {
					r.ConsumerGroup.Tags = append(r.ConsumerGroup.Tags, types.StringValue(v))
				}
			}
			r.ConsumerGroup.UpdatedAt = types.Int64PointerValue(resp.ConsumerGroup.UpdatedAt)
		}
		r.Consumers = []tfTypes.Consumer{}

		for _, consumersItem := range resp.Consumers {
			var consumers tfTypes.Consumer

			consumers.CreatedAt = types.Int64PointerValue(consumersItem.CreatedAt)
			consumers.CustomID = types.StringPointerValue(consumersItem.CustomID)
			consumers.ID = types.StringPointerValue(consumersItem.ID)
			if consumersItem.Tags != nil {
				consumers.Tags = make([]types.String, 0, len(consumersItem.Tags))
				for _, v := range consumersItem.Tags {
					consumers.Tags = append(consumers.Tags, types.StringValue(v))
				}
			}
			consumers.UpdatedAt = types.Int64PointerValue(consumersItem.UpdatedAt)
			consumers.Username = types.StringPointerValue(consumersItem.Username)

			r.Consumers = append(r.Consumers, consumers)
		}
	}

	return diags
}

func (r *ConsumerGroupMemberResourceModel) ToOperationsAddConsumerToGroupRequest(ctx context.Context) (*operations.AddConsumerToGroupRequest, diag.Diagnostics) {
	var diags diag.Diagnostics

	var consumerGroupID string
	consumerGroupID = r.ConsumerGroupID.ValueString()

	var workspace string
	workspace = r.Workspace.ValueString()

	requestBody, requestBodyDiags := r.ToOperationsAddConsumerToGroupRequestBody(ctx)
	diags.Append(requestBodyDiags...)

	if diags.HasError() {
		return nil, diags
	}

	out := operations.AddConsumerToGroupRequest{
		ConsumerGroupID: consumerGroupID,
		Workspace:       workspace,
		RequestBody:     requestBody,
	}

	return &out, diags
}

func (r *ConsumerGroupMemberResourceModel) ToOperationsAddConsumerToGroupRequestBody(ctx context.Context) (*operations.AddConsumerToGroupRequestBody, diag.Diagnostics) {
	var diags diag.Diagnostics

	consumerID := new(string)
	if !r.ConsumerID.IsUnknown() && !r.ConsumerID.IsNull() {
		*consumerID = r.ConsumerID.ValueString()
	} else {
		consumerID = nil
	}
	out := operations.AddConsumerToGroupRequestBody{
		ConsumerID: consumerID,
	}

	return &out, diags
}

func (r *ConsumerGroupMemberResourceModel) ToOperationsRemoveConsumerFromGroupRequest(ctx context.Context) (*operations.RemoveConsumerFromGroupRequest, diag.Diagnostics) {
	var diags diag.Diagnostics

	var consumerGroupID string
	consumerGroupID = r.ConsumerGroupID.ValueString()

	var consumerID string
	consumerID = r.ConsumerID.ValueString()

	var workspace string
	workspace = r.Workspace.ValueString()

	out := operations.RemoveConsumerFromGroupRequest{
		ConsumerGroupID: consumerGroupID,
		ConsumerID:      consumerID,
		Workspace:       workspace,
	}

	return &out, diags
}
